
<script src="../..app/assets/javascripts/responsive_waterfall.js"></script>

<style>
  body {
    overflow-x: hidden !important;
  }
</style>






<div class="title" style="padding-top:30px">
  <h2>MY STYLE</h2>
</div>
<!--  <%= link_to "BACK", :back, class: "filter-btn", style: "margin:20px;width:90px" %> -->

<!-- PROFILE-MENU -->
<div class="inner-panel" style="text-align: center;">
  <a href="#popup1" class="form-btn">Change Password</a> |
  <%= link_to "Delete Account", registration_path(resource_name), class: "form-btn", data: { confirm: "Are you sure?" }, method: :delete %>
</div>


<!-- UGC BOARD -->
<div class="wf-container">
  <div class="page-title">
    <h4>My Wardrobe</h4>
    <% if current_user.ugcs.empty? %>
      <br><h6 style="text-align: center">Empty! Add photos below</h6>
  </div>
    <% else %>
      <% @ugcs.each do |ugc| %>
        <div class="content" style="text-align:center;align-items:center;">
          <%= cl_image_tag ugc.photo_url, style: "padding-bottom:15px" %>
          <h5><%= ugc.title %></h5>
          <h5><%= ugc.brand %></h5>
          <h5><%= ugc.comment %></h5>
          <%= link_to "Delete", ugc_path(ugc), class: "form-btn", data: { confirm: "Are you sure?" }, method: :delete %>
        </div>
      <% end %>
    <% end %>

</div>


<!-- ADD UGC -->
<div class="wrapper">
  <h4>Add to Your Wardrobe</h4>
    <div class="user-form-container">
      <%= simple_form_for [@ugc] do |f| %>
        <div class="field">
          <%= f.input :title, { maxlength: 100 }%>
        </div>
        <div class="field">
          <%= f.input :brand, { maxlength: 100 } %>
        </div>
        <div class="field">
          <%= f.input :comment, { maxlength: 250 } %>
        </div>
        <div class="field">
          <%= f.file_field :photo_url, class: "file-btn" %>
        </div>
        <%= f.submit "Submit", class: "btn" %>
      <% end %>
    </div>
</div>





<!-- PRODUCT WISHLIST -->
<h4 class="page-title" style="text-align:center;">Wishlist</h4>
<div class="wf-container">
  <div class="collapse-nav">
    <%= render "devise/shared/navbar" %>
  </div>
  <div class="main-carousel">
    <% if current_user.liked_products.nil? %>
      <p><h6>No liked products!</h6></p>
      <% else %>
       <% current_user.liked_products.each do |product| %>
          <% if product.image_url.nil? %>
            <p><h3>No Image Here, Sorry!</h3></p>
            <% else %>
              <div class="card" style="background:#F2EFEB">
               <%= cl_image_tag product.image_url, style: "padding-bottom:15px" %>
                <div class="Wishlist-content" style="padding:5px ">
                  <h6 style="font-weight:700" ><%= product.name %></h6>
                  <h6><%= link_to "Buy", product.url, target: "blank", class: "black-white-link"%></h6>
                  <h6><%= product.brand.name %></h6>
                  <h6>$<%= product.price %></h6>
                </div>
              </div>
          <% end %>
      <% end %>
    <% end %>
  </div>
</div>

<script src="https://unpkg.com/flickity@2/dist/flickity.pkgd.min.js"></script>

<br><br>

<!-- BRANDS LIKED -->
<div class="wf-container">
  <div class="page-title">
    <h4>My Brands</h4>

    <% if current_user.liked_brand_images.empty? %>
      <br><h6 style="text-align: center">No liked brands!</h6>
  </div>
    <% else %>
      <% brand_ids = [] %>
      <% current_user.liked_brand_images.each do |image| %>
        <% if brand_ids.include?(image.brand_id) %>
        <% else %>
          <% brand_ids << image.brand_id %>
          <div class="wf-box">
            <% bimages = current_user.liked_brand_images.where("brand_id = #{image.brand_id}") %>
            <% bimages.each do |bimage| %>
              <%= cl_image_tag bimage.url, style: "border-top-left-radius:20px;border-top-right-radius:20px;"%>
            <% end %>
            <div class="content" style="text-align:center;align-items:center;">
              <h3><%= link_to image.brand.name, image.brand.url, target:"blank", style:"color:black;"%></h3>
              <h5><%= image.brand.country %></h5>
            </div>
          </div>
        <% end %>
      <% end %>
    </div>
  <% end %>
</div>







<script src="https://unpkg.com/flickity@2/dist/flickity.pkgd.min.js"></script>


<!-- POP-UP EDIT FORM -->
<div id="popup1" class="overlay">
    <div class="popup">
    <a class="close" href="#">&times;</a>
    <div>

    <%= simple_form_for(resource, as: resource_name, url: registration_path(resource_name), html: { method: :put }) do |f| %>
      <%= f.error_notification %>
      <div class="form-inputs">
        <%= f.input :email, required: true, autofocus: true %>
        <% if devise_mapping.confirmable? && resource.pending_reconfirmation? %>
          <p>Currently waiting confirmation for: <%= resource.unconfirmed_email %></p>
        <% end %>
        <%= f.input :current_password,
                    hint: "If you want to change password, please enter your current password",
                    required: true,
                    input_html: { autocomplete: "current-password" } %>
        <%= f.input :password,
                    hint: "If you don't want to change password, please leave it blank",
                    required: false,
                    input_html: { autocomplete: "new-password" } %>
        <%= f.input :password_confirmation,
                    required: false,
                    input_html: { autocomplete: "new-password" } %>
      </div>
      <div class="form-btn">
        <%= f.button :submit, "Update" %>
      </div>
    <% end %>
    </div>

<!-- CAROUSEL JS -->
<script type="text/javascript">
// external js: flickity.pkgd.js
var carousel = document.querySelector('.main-carousel');
var flkty = new Flickity( carousel, {
  imagesLoaded: true,
  percentPosition: false,
  freeScroll: true,
  contain: true,
  // disable previous & next buttons and dots
  prevNextButtons: false,
  pageDots: false,
  autoPlay: true
});

var imgs = carousel.querySelectorAll('.card');
// get transform property
var docStyle = document.documentElement.style;
var transformProp = typeof docStyle.transform == 'string' ?
  'transform' : 'WebkitTransform';

flkty.on( 'scroll', function() {
  flkty.slides.forEach( function( slide, i ) {
    var img = imgs[i];
    var x = ( slide.target + flkty.x ) * -1/100;
    img.style[ transformProp ] = 'translateX(' + x  + 'px)';
  });
});
</script>

